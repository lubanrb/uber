version: "3"

services:
  <%= application %>:
    build: ./context
    image: <%= build[:image_tag] %>
    volumes:
      - projects:<%= deployment_projects_path %>
      - downloads:<%= downloads_path %>
      - docker:<%= docker_root_path %>
      - packages:<%= packages_root_path %>
      - releases:<%= releases_root_path %>
      - env:<%= env_path %>
      - /var/run/docker.sock:/var/run/docker.sock
      - $HOME/.docker:/home/<%= luban_user %>/.docker
      - $HOME/.ssh:/home/<%= luban_user %>/.ssh
      - $HOME/.lubanrc:/home/<%= luban_user %>/.lubanrc
      - $HOME/.gitconfig:/home/<%= luban_user %>/.gitconfig
    entrypoint: /bin/bash
    stdin_open: true
    tty: true

volumes:
  projects:
  downloads:
  docker:
  packages:
  releases:
  env:
